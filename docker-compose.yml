# docker-compose.yml
version: '3.8'

services:
 nextjs:
  build:
   context: .
   dockerfile: Dockerfile
  container_name: nextjs_app
  restart: unless-stopped
  expose:
   - '3000'
  environment:
   - NODE_ENV=production
   - PORT=3000
  networks:
   - app_network
  # Optional: persist data nếu cần
  # volumes:
  #   - ./data:/app/data

 nginx:
  image: nginx:alpine
  container_name: nginx_proxy
  restart: unless-stopped
  ports:
   - '80:80'
   - '443:443'
  volumes:
   - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
   - ./nginx/ssl:/etc/nginx/ssl:ro # For SSL certificates
   # Optional: Nginx logs
   - ./nginx/logs:/var/log/nginx
  depends_on:
   - nextjs
  networks:
   - app_network

networks:
 app_network:
  driver: bridge
# Optional: Add this if you need to persist data
# volumes:
#   app_data:
